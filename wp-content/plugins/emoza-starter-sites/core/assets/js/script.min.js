"use strict";!function(e){var t,i,c=e("body"),o=1,r=!1,n=function n(m,a,s){if(s++,a.length>s&&a[s]){var l=a[s].log||"",d=Math.max(5,Math.round(100/a.length*s));m.find(".emwc-import-progress-label").html(l),m.find(".emwc-import-progress-sublabel").html(d+"%"),m.find(".emwc-import-progress-indicator").attr("style","--emwc-indicator: "+d+"%;");var p=window.emwc_localize.nonce,w=m.find('input[name="demo_id"]').val(),u=m.find('input[name="builder_type"]:checked').val(),f=m.find('input[name="content_type"]:checked').val(),v=m.find('input[name="emwc_color_scheme"]').val(),h=m.find('input[name="emwc_logo_url"]').val(),g=m.find('input[name="emwc_icon_url"]').val(),b=e.extend({nonce:p,demo_id:w,builder_type:u,content_type:f,color_scheme:v,logo:h,favicon:g},a[s]);delete b.log,delete b.priority,e.post(window.emwc_localize.ajax_url,b,function(e){if(e.success)e.status&&"newAJAX"===e.status&&s--,setTimeout(function(){n(m,a,s)},500);else if(e.data)m.find(".emwc-import-step-error").addClass("emwc-active").siblings().removeClass("emwc-active"),m.find(".emwc-import-error-log").html(e.data),c.removeClass("emwc-import-in-progress");else{var t=window.emwc_localize.i18n.import_failed;e&&(t+='<div class="emwc-import-error-response">'+_.escape(e)+"</div>"),m.find(".emwc-import-step-error").addClass("emwc-active").siblings().removeClass("emwc-active"),m.find(".emwc-import-error-log").html(t),c.removeClass("emwc-import-in-progress")}}).fail(function(){m.find(".emwc-import-step-error").addClass("emwc-active").siblings().removeClass("emwc-active"),m.find(".emwc-import-error-log").html(window.emwc_localize.i18n.import_failed),c.removeClass("emwc-import-in-progress")})}else{m.find(".emwc-import-progress-label").html(window.emwc_localize.i18n.import_finished),m.find(".emwc-import-progress-sublabel").html("100%"),m.find(".emwc-import-progress-indicator").attr("style","--emwc-indicator: 100%;");var k=window.emwc_localize.i18n.tweet_text.replace("{0}",o);m.find(".emwc-import-finish-tweet-text").html(k),m.find(".emwc-import-finish-tweet-button").attr("href","https://twitter.com/intent/tweet?text="+k),setTimeout(function(){m.find(".emwc-import-step").removeClass("emwc-active"),m.find(".emwc-import-step-finish").addClass("emwc-active"),c.removeClass("emwc-import-in-progress")},250),i.addClass("emwc-demo-item-imported").siblings().removeClass("emwc-demo-item-imported"),clearInterval(t),o=1}r=!0};e(document).ready(function(){var m=e(".emwc-notice");m.length&&m.find(".notice-dismiss").on("click",function(){m.parent().hide(),e.post(window.emwc_localize.ajax_url,{action:"emwc_dismissed_handler",nonce:window.emwc_localize.nonce})});var a=e(".emwc");if(a.length){var s,l=a.find(".emwc-demo-item");a.find(".emwc-import");var d=a.find(".emwc-preview");a.on("click",".emwc-demo-preview-button",function(t){t.preventDefault();var i=e(this),o=i.closest(".emwc-demo-item"),r={preview:i.attr("href"),info:o.find(".emwc-demo-info").html(),actions:o.find(".emwc-demo-actions").html()};if(c.hasClass("emwc-preview-show"))d.find(".emwc-preview-iframe").attr("src",r.preview),d.find(".emwc-preview-header-info").html(r.info),d.find(".emwc-preview-header-actions").html(r.actions);else{var n=wp.template("emwc-preview");d.html(n(r))}c.addClass("emwc-preview-show"),s=o.index(),a.trigger("emwc-nav-click",[s])}),a.on("click",".emwc-preview-header-arrow-prev",function(t){t.preventDefault(),e(this).hasClass("emwc-disabled")||(s--,l.eq(s).find(".emwc-demo-preview-button").trigger("click"))}),a.on("click",".emwc-preview-header-arrow-next",function(t){t.preventDefault(),e(this).hasClass("emwc-disabled")||(s++,l.eq(s).find(".emwc-demo-preview-button").trigger("click"))}),a.on("click",".emwc-preview-cancel-button",function(e){e.preventDefault(),c.removeClass("emwc-preview-show"),d.empty()}),a.on("emwc-nav-click",function(e,t){var i=a.find(".emwc-preview-header-arrow-prev"),c=a.find(".emwc-preview-header-arrow-next");0===t?(i.addClass("emwc-disabled"),c.removeClass("emwc-disabled")):l.length-1===t?(c.addClass("emwc-disabled"),i.removeClass("emwc-disabled")):(c.removeClass("emwc-disabled"),i.removeClass("emwc-disabled"))}),a.on("click",".emwc-demo-remove-button",function(t){t.preventDefault(),e(this).closest(".emwc-demo-item").find(".emwc-import-open-button").trigger("click"),a.find(".emwc-import-step.emwc-active .emwc-import-next-button").trigger("click"),a.find(".emwc-import-form .emwc-import-checkboxes:first-of-type input").prop("checked",!1),a.find(".emwc-import-form .emwc-import-clean-checkboxes input").prop("checked",!0)}),a.on("click",".emwc-import-open-button",function(t){t.preventDefault();var o=e(this).data("demo-id"),n=e(this).data("color-scheme"),m=window.emwc_localize.demos[o],s=wp.template("emwc-import");m&&m.builders.length&&(i=e(this).closest(".emwc-demo-item"),m.args={},m.args.demoId=o,m.args.colorScheme=n,m.args.quick=e(this).data("quick")||m.builders.length<2||!1,m.args.builder=e(this).data("builder")||m.builders[0],m.args.imported=window.emwc_localize.imported||r,a.find(".emwc-import").html(s(m)),c.addClass("emwc-import-show"));var l=function(e){var t;document.getElementById("emwc-demo-frame").contentWindow.postMessage(JSON.stringify({command:"changeColorPalette",palette:e}),"*")},d=document.querySelectorAll(".emwc-color-picker"),p=document.querySelectorAll(".emwc-color-picker-input"),w=[];p.forEach(function(e,t){e.setAttribute("data-index",t),e.addEventListener("change",function(){w[e.getAttribute("data-index")]=e.value,l(w)})}),d.forEach(function(e){let t=Pickr.create({el:e.querySelector(".pickr-holder"),theme:"emwc",default:e.querySelector(".emwc-color-picker-input").value,sliders:"h",swatches:[],components:{preview:!0,opacity:!0,hue:!0,interaction:{hex:!0,rgba:!0,input:!0,clear:!0,save:!1}}});t.on("change",function(i){1===i.a?(t.setColorRepresentation("HEX"),c=i.toHEXA().toString(0)):(t.setColorRepresentation("RGBA"),c=i.toRGBA().toString(0));var c,o=e.querySelector(".emwc-color-picker-input");o.value=c,o.dispatchEvent(new Event("change")),e.querySelector(".pcr-button").style.backgroundColor=c}),e.parentElement.parentElement.parentElement.querySelector(".emwc-import-reset-button").addEventListener("click",function(){t.setColor(e.querySelector(".emwc-color-picker-input").getAttribute("data-default"))})})});var p=function(e){var t;document.getElementById("emwc-demo-frame").contentWindow.postMessage(JSON.stringify({command:"changeLogo",logo:e}),"*")};a.on("click",".emwc-media-button",function(t){var i;if(t.preventDefault(),i){i.open();return}(i=wp.media({frame:"post",state:"insert",multiple:!1})).on("insert",function(){var c=i.state().get("selection").first().toJSON();e(t.target).hasClass("emwc-logo-upload-button")?(e(".emwc-logo-upload-input").val(c.url),p(c.url)):e(".emwc-icon-upload-input").val(c.url)}),i.open()}),a.on("click",".emwc-import-close-button",function(e){e.preventDefault(),c.removeClass("emwc-import-show")}),a.on("click",".emwc-import-toggle-button",function(t){t.preventDefault(),e(this).parent().toggleClass("emwc-active")}),a.on("click",".emwc-import-prev-button",function(t){t.preventDefault();var i=e(this).closest(".emwc-import-step");i.removeClass("emwc-active"),i.prev().addClass("emwc-active")}),a.on("click",".emwc-import-next-button",function(t){t.preventDefault();var i=e(this).closest(".emwc-import-step");i.removeClass("emwc-active"),i.next().addClass("emwc-active"),e(this).hasClass("emwc-import-customize-button")?a.find(".emwc-import-form").addClass("emwc-import-form-customize"):a.find(".emwc-import-form").removeClass("emwc-import-form-customize");var c=a.find(".emwc-import-form");if(e(this).hasClass("emwc-import-save-custom-data-button")){t.preventDefault();var o=window.emwc_localize.nonce,r=c.find(".emwc-color-picker-input"),n=[];r.each(function(){n.push(e(this).val())});var m=c.find('input[name="emwc_logo_url"]').val(),s=c.find('input[name="emwc_icon_url"]').val();e.ajax({url:window.emwc_localize.ajax_url,data:{action:"save_emwc_custom_data",nonce:o,color_scheme:n,logo:m,favicon:s},method:"POST",success:function(e){console.log(e)},error:function(e){console.log(e)}})}}),a.on("click",".emwc-import-skip-button",function(t){t.preventDefault();var i=e(this).closest(".emwc-import-step");i.removeClass("emwc-active"),i.next().next().addClass("emwc-active")}),a.on("change",".emwc-import-builder-select input",function(t){if(a.find(".emwc-import-plugin-builder").addClass("emwc-hidden"),a.find(".emwc-import-plugin-builder input").prop("checked",!1),e(this).is(":checked")){var i=a.find(".emwc-import-plugin-"+e(this).data("builder-plugin"));"elementor"===e(this).data("builder-plugin")?(a.find(".emwc-import-plugin-stackable-ultimate-gutenberg-blocks").addClass("emwc-hidden"),a.find(".emwc-import-plugin-stackable-ultimate-gutenberg-blocks input").prop("checked",!1)):(a.find(".emwc-import-plugin-stackable-ultimate-gutenberg-blocks").removeClass("emwc-hidden"),a.find(".emwc-import-plugin-stackable-ultimate-gutenberg-blocks input").prop("checked",!0)),i.removeClass("emwc-hidden"),i.find("input").prop("checked",!0)}}),a.on("click",".emwc-import-with-content-type",function(){var t=!0;e(".emwc-import-with-content-type").each(function(){e(this).is(":checked")||(t=!1)}),t?a.find(".emwc-import-content-select").removeClass("emwc-hidden"):a.find(".emwc-import-content-select").addClass("emwc-hidden")}),a.on("click",".emwc-import-start-button",function(i){i.preventDefault();var r=a.find(".emwc-import-form");if(e(this).data("subscribe")){var m=r.find(".emwc-import-subscribe-field-email"),s=m.val();if(!/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(s)){m.addClass("emwc-error").attr("placeholder",window.emwc_localize.i18n.invalid_email).val("");return}}var l=e(this).closest(".emwc-import-step");l.removeClass("emwc-active"),l.next().addClass("emwc-active");var d=[];r.find("input[data-action]").each(function(t){(e(this).is(":checked")||e(this).is('[type="hidden"]'))&&d.push(e(this).data())}),d=d.sort(function(e,t){return e.priority-t.priority}),o=1,t=setInterval(function(){o++},1e3),c.addClass("emwc-import-in-progress"),n(r,d,-1)})}})}(jQuery);